command: docker commit
short: コンテナーの変更に基づいて新たなイメージを生成します。
long: |-
  コンテナー内のファイル変更や設定を、新たなイメージにコミットできると、役に立つことがあります。
  これがあれば、コンテナーを対話型シェルにおいて起動しながらデバッグできたり、あるいは操作中のデータセットを別サーバーにエクスポートしたりできます。
  一般的には Dockerfile にすべてを記述して、保守しやすい方法でイメージを管理していくことの方が望ましいことです。
  [適切なイメージ名とタグ](tag.md) をさらに参照してください。

  コミット操作を行っても、コンテナー内のマウントボリュームのデータは含まれません。

  イメージがコミットされる間、コミット対象のコンテナーとそのプロセスはデフォルトで停止します。
  こうするのは、コミット処理の最中にデータ損傷の可能性を軽減するためです。
  この動作が必要ない場合は`--pause`オプションに false を設定してください。

  `--change`オプションを指定すると、イメージの生成時に`Dockerfile`命令をイメージに適用できます。
  サポートされている`Dockerfile`命令は以下のとおりです。
  `CMD`|`ENTRYPOINT`|`ENV`|`EXPOSE`|`LABEL`|`ONBUILD`|`USER`|`VOLUME`|`WORKDIR`
usage: docker commit [オプション] CONTAINER [REPOSITORY[:TAG]]
pname: docker
plink: docker.yaml
options:
- option: author
  shorthand: a
  value_type: string
  description: 作者名（たとえば "John Hannibal Smith \<hannibal@a-team.com\>"）。
  deprecated: false
  experimental: false
  experimentalcli: false
  kubernetes: false
  swarm: false
- option: change
  shorthand: c
  value_type: list
  description: 生成されたイメージに Dockerfile 命令を適用します。
  deprecated: false
  experimental: false
  experimentalcli: false
  kubernetes: false
  swarm: false
- option: message
  shorthand: m
  value_type: string
  description: コミットメッセージ。
  deprecated: false
  experimental: false
  experimentalcli: false
  kubernetes: false
  swarm: false
- option: pause
  shorthand: p
  value_type: bool
  default_value: "true"
  description: コミット中はコンテナーを停止します。
  deprecated: false
  experimental: false
  experimentalcli: false
  kubernetes: false
  swarm: false
examples: |-
  {: #commit-a-container }
  ### コンテナーのコミット

  ```bash
  $ docker ps

  CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS              NAMES
  c3f279d17e0a        ubuntu:12.04        /bin/bash           7 days ago          Up 25 hours                            desperate_dubinsky
  197387f1b436        ubuntu:12.04        /bin/bash           7 days ago          Up 25 hours                            focused_hamilton

  $ docker commit c3f279d17e0a  svendowideit/testimage:version3

  f5283438590d

  $ docker images

  REPOSITORY                        TAG                 ID                  CREATED             SIZE
  svendowideit/testimage            version3            f5283438590d        16 seconds ago      335.7 MB
  ```

  {: #commit-a-container-with-new-configurations }
  ### 新たな設定を利用したコンテナーのコミット

  ```bash
  $ docker ps

  CONTAINER ID       IMAGE               COMMAND             CREATED             STATUS              PORTS              NAMES
  c3f279d17e0a        ubuntu:12.04        /bin/bash           7 days ago          Up 25 hours                            desperate_dubinsky
  197387f1b436        ubuntu:12.04        /bin/bash           7 days ago          Up 25 hours                            focused_hamilton

  $ docker inspect -f "{{ .Config.Env }}" c3f279d17e0a

  [HOME=/ PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin]

  $ docker commit --change "ENV DEBUG true" c3f279d17e0a  svendowideit/testimage:version3

  f5283438590d

  $ docker inspect -f "{{ .Config.Env }}" f5283438590d

  [HOME=/ PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin DEBUG=true]
  ```

  {: #commit-a-container-with-new-cmd-and-expose-instructions }
  ### 新たな`CMD`、`EXPOSE`命令によるコンテナーのコミット

  ```bash
  $ docker ps

  CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS              NAMES
  c3f279d17e0a        ubuntu:12.04        /bin/bash           7 days ago          Up 25 hours                            desperate_dubinsky
  197387f1b436        ubuntu:12.04        /bin/bash           7 days ago          Up 25 hours                            focused_hamilton

  $ docker commit --change='CMD ["apachectl", "-DFOREGROUND"]' -c "EXPOSE 80" c3f279d17e0a  svendowideit/testimage:version4

  f5283438590d

  $ docker run -d svendowideit/testimage:version4

  89373736e2e7f00bc149bd783073ac43d0507da250e999f3f1036e0db60817c0

  $ docker ps

  CONTAINER ID        IMAGE               COMMAND                 CREATED             STATUS              PORTS              NAMES
  89373736e2e7        testimage:version4  "apachectl -DFOREGROU"  3 seconds ago       Up 2 seconds        80/tcp             distracted_fermat
  c3f279d17e0a        ubuntu:12.04        /bin/bash               7 days ago          Up 25 hours                            desperate_dubinsky
  197387f1b436        ubuntu:12.04        /bin/bash               7 days ago          Up 25 hours                            focused_hamilton
  ```
deprecated: false
experimental: false
experimentalcli: false
kubernetes: false
swarm: false

